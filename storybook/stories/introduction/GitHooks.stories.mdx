import { Meta } from '@storybook/addon-docs/blocks';

<Meta title="Introduction/Гит-хуки"
      parameters={{
        previewTabs: {
          canvas: {
            hidden: true,
          },
        },
      }} />

# Гит-хуки

**Содержание:**

+ [Pre-commit](#pre-commit)
+ [Pre-push](#pre-push)
+ [Pre-commit-msg](#pre-commit)
+ [Рекомендации](#рекомендации)

<br/>

Git hooks — инструмент который помогает нам держать в порядке репозиторий, и даже новым членам команды соблюдать Code Style.

Для автоматической настройки прекоммит-хуков мы используем пакет `Husky`.
Это означает, что у нас появляется возможность выполнять некоторые обазательные действия перед выполнением коммита (`git commit`)
и перед отправкой кода репозиторий (`git push`) - автоматически.

Перед выполнением команды `commit` или `push` вызываются скрипты, которые выполняют тестирование кода и его форматирование.

## Pre-commit

Перед выполнением команды `commit` вызываются скрипты, которые выполняют тестирование кода и его форматирование:

```bach
yarn lint-staged
yarn check:version
```

**Что делают эти скрипты:**

+ `yarn lint-staged` - проводт форматирование кода в тех файлах которые были изменены и добавлены к коммиту (индексированные файлы). Вызывает скрипты `yarn lint:js-fix` и `yarn lint:css-fix`
+ `check:version` - проводит проверку версии библиотеки, и, если локальная версия совпадает с опубликованной, или же версия поднята некорректно, выводит вопрос в консоли с тремя вариантами новой версии (magor, minor, path), после выбора которой обновляет packagae.json

## Pre-push

Перед выполнением команды `push` вызываются скрипты, которые проверяют код и запускают тесты, чтобы не допустить пуша со сломанными компонентами и не запускать "холостой" пайплан для проверки тестов.

```bach
yarn types
yarn unit:test:changed
```

**Что делают эти скрипты:**

+ `yarn types` - проверяет типы
+ `yarn unit:test:changed` - запускает unit-тесты для измененных файлов.

## Pre-commit-msg

Перед выполнением команды `commit` вызывается скрипт, который автоматически добавит в вашему message коммита префикс с номером вашей задачи.

⚠️ _На данный момент скрипт работает только для задач из пространства BXFE_

## Рекомендации

❗️ Настоятельно рекомендуем дождаться выполнения всех хуков и не пропускать их, дабы не запускать много пайплайнов только ради проверок кода на линтеры и тесты.
Всё это можно проверить локально, и мы, со своей стороны, максимально постарались облегчить все эти проверки.
